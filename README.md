# Reverse Proxy Control Center v4

Система управления обратными прокси и мониторинга серверов с использованием Glances API. Оптимизированная версия с фокусом на стабильность и производительность.

## Особенности

- Мониторинг серверов через Glances API (отказ от MQTT и прямого SSH-мониторинга)
- Управление доменами и обратными прокси с асинхронной обработкой операций
- Интеграция с Telegram для уведомлений о важных событиях
- Поддержка PostgreSQL для надежного хранения данных конфигураций
- Интуитивно понятный веб-интерфейс с улучшенной диагностикой
- Фоновая обработка длительных операций для предотвращения таймаутов gunicorn

## Требования

- Ubuntu 22.04 или новее
- Python 3.10+
- PostgreSQL
- Nginx
- Git

## Установка

Для установки выполните следующие команды:

```bash
# Клонировать репозиторий
git clone https://github.com/globalduckmac/revers_proxy_control_center_v4.git /tmp/rpcc

# Перейти в директорию с проектом
cd /tmp/rpcc

# Запустить скрипт установки
sudo bash deploy_script.sh
```

## Исправление проблем с импортами

Если у вас возникли проблемы с запуском приложения из-за ошибок импорта, выполните:

```bash
# Перейти в директорию с проектом
cd /opt/reverse_proxy_control_center

# Запустить скрипт исправления импортов
sudo bash fix_imports.sh

# Перезапустить сервис
sudo systemctl restart reverse_proxy_control_center
```

## Диагностика и устранение проблем

Для диагностики проблем используйте встроенный инструмент:

```bash
sudo rpcc-diagnose
```

Для проверки логов:

```bash
# Логи веб-приложения
sudo journalctl -u reverse_proxy_control_center -n 50

# Логи Nginx
sudo tail -f /var/log/nginx/error.log
```

## Настройка базы данных

Если у вас возникли проблемы с подключением к базе данных, можно воспользоваться скриптом:

```bash
# Перейти в директорию с проектом
cd /opt/reverse_proxy_control_center

# Запустить скрипт настройки базы данных
sudo bash fix_db.sh
```

## Ключевые улучшения в версии 4

- Отказ от устаревшего MQTT-мониторинга в пользу Glances API
- Асинхронное выполнение длительных операций (развертывание конфигураций, получение SSL-сертификатов)
- Улучшенная обработка ошибок и логирование
- Сохранение конфигураций в базе данных для надежного восстановления
- Оптимизация производительности для работы с большим количеством серверов

## Контакты

При возникновении проблем создайте issue в этом репозитории.
